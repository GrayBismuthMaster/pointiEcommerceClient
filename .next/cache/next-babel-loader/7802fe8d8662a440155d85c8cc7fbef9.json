{"ast":null,"code":"import jwtDecode from 'jwt-decode';\nconst ACCESS_TOKEN_KEY = 'token';\nconst API_URL = 'http://localhost:9000';\nconst ISSERVER = true;\nexport function getAccessToken() {\n  if (!ISSERVER) {\n    return localStorage.getItem(ACCESS_TOKEN_KEY);\n  }\n}\nexport function getUser() {\n  const token = getAccessToken();\n  console.log(\"desde el getUser\", token);\n\n  if (!token) {\n    return null;\n  }\n\n  return getUserFromToken(token);\n}\nexport async function login(userId, password) {\n  const response = await fetch(`${API_URL}/login`, {\n    method: 'POST',\n    headers: {\n      'content-type': 'application/json'\n    },\n    body: JSON.stringify({\n      userId,\n      password\n    })\n  });\n\n  if (response.ok) {\n    const {\n      token\n    } = await response.json();\n    localStorage.setItem(ACCESS_TOKEN_KEY, token);\n    return {\n      id: userId\n    };\n  }\n\n  return null;\n}\nexport function logout() {\n  localStorage.removeItem(ACCESS_TOKEN_KEY);\n}\n\nfunction getUserFromToken(token) {\n  console.log(\"desde el getUserFromToken\", token);\n  const jwtPayload = jwtDecode(token);\n  console.log(jwtPayload.sub);\n  return {\n    usuario: {\n      id: jwtPayload.sub\n    }\n  };\n}","map":{"version":3,"sources":["D:/Programming/Trabajo/MGRN/EcommercePointi/client/auth/auth.js"],"names":["jwtDecode","ACCESS_TOKEN_KEY","API_URL","ISSERVER","getAccessToken","localStorage","getItem","getUser","token","console","log","getUserFromToken","login","userId","password","response","fetch","method","headers","body","JSON","stringify","ok","json","setItem","id","logout","removeItem","jwtPayload","sub","usuario"],"mappings":"AAAA,OAAOA,SAAP,MAAsB,YAAtB;AACA,MAAMC,gBAAgB,GAAG,OAAzB;AACA,MAAMC,OAAO,GAAG,uBAAhB;AACA,MAAMC,QAAQ,OAAd;AAEA,OAAO,SAASC,cAAT,GAA0B;AAC/B,MAAG,CAACD,QAAJ,EAAc;AACZ,WAAOE,YAAY,CAACC,OAAb,CAAqBL,gBAArB,CAAP;AACD;AACF;AAED,OAAO,SAASM,OAAT,GAAmB;AAEtB,QAAMC,KAAK,GAAGJ,cAAc,EAA5B;AACAK,EAAAA,OAAO,CAACC,GAAR,CAAY,kBAAZ,EAAgCF,KAAhC;;AACA,MAAI,CAACA,KAAL,EAAY;AACV,WAAO,IAAP;AACD;;AACD,SAAOG,gBAAgB,CAACH,KAAD,CAAvB;AAGH;AAED,OAAO,eAAeI,KAAf,CAAqBC,MAArB,EAA6BC,QAA7B,EAAuC;AAC5C,QAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAE,GAAEd,OAAQ,QAAZ,EAAqB;AAC/Ce,IAAAA,MAAM,EAAE,MADuC;AAE/CC,IAAAA,OAAO,EAAE;AACP,sBAAgB;AADT,KAFsC;AAK/CC,IAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;AAAER,MAAAA,MAAF;AAAUC,MAAAA;AAAV,KAAf;AALyC,GAArB,CAA5B;;AAOA,MAAIC,QAAQ,CAACO,EAAb,EAAiB;AACf,UAAM;AAAEd,MAAAA;AAAF,QAAY,MAAMO,QAAQ,CAACQ,IAAT,EAAxB;AACAlB,IAAAA,YAAY,CAACmB,OAAb,CAAqBvB,gBAArB,EAAuCO,KAAvC;AACA,WAAO;AAAEiB,MAAAA,EAAE,EAAEZ;AAAN,KAAP;AACD;;AACD,SAAO,IAAP;AACD;AAED,OAAO,SAASa,MAAT,GAAkB;AACvBrB,EAAAA,YAAY,CAACsB,UAAb,CAAwB1B,gBAAxB;AACD;;AAED,SAASU,gBAAT,CAA0BH,KAA1B,EAAiC;AAC/BC,EAAAA,OAAO,CAACC,GAAR,CAAY,2BAAZ,EAAyCF,KAAzC;AACA,QAAMoB,UAAU,GAAG5B,SAAS,CAACQ,KAAD,CAA5B;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAYkB,UAAU,CAACC,GAAvB;AACA,SAAO;AAAEC,IAAAA,OAAO,EAAC;AAACL,MAAAA,EAAE,EAAEG,UAAU,CAACC;AAAhB;AAAV,GAAP;AACD","sourcesContent":["import jwtDecode from 'jwt-decode';\r\nconst ACCESS_TOKEN_KEY = 'token';\r\nconst API_URL = 'http://localhost:9000';\r\nconst ISSERVER = typeof window === \"undefined\";\r\n\r\nexport function getAccessToken() {\r\n  if(!ISSERVER) {\r\n    return localStorage.getItem(ACCESS_TOKEN_KEY);\r\n  }\r\n}\r\n\r\nexport function getUser() {\r\n  \r\n    const token = getAccessToken();\r\n    console.log(\"desde el getUser\", token);\r\n    if (!token) {\r\n      return null;\r\n    }\r\n    return getUserFromToken(token);\r\n\r\n  \r\n}\r\n\r\nexport async function login(userId, password) {\r\n  const response = await fetch(`${API_URL}/login`, {\r\n    method: 'POST',\r\n    headers: {\r\n      'content-type': 'application/json',\r\n    },\r\n    body: JSON.stringify({ userId, password }),\r\n  });\r\n  if (response.ok) {\r\n    const { token } = await response.json();\r\n    localStorage.setItem(ACCESS_TOKEN_KEY, token);\r\n    return { id: userId };\r\n  }\r\n  return null;\r\n}\r\n\r\nexport function logout() {\r\n  localStorage.removeItem(ACCESS_TOKEN_KEY);\r\n}\r\n\r\nfunction getUserFromToken(token) {\r\n  console.log(\"desde el getUserFromToken\", token);\r\n  const jwtPayload = jwtDecode(token)\r\n  console.log(jwtPayload.sub);\r\n  return { usuario:{id: jwtPayload.sub} };\r\n}\r\n"]},"metadata":{},"sourceType":"module"}