{"ast":null,"code":"import _regeneratorRuntime from \"D:/Cursos/FrontEnd Javascript/Next/React Avanzado Fullstack Next.js, Apollo, MongoDB y GraphQL/Ejercicios/cliente/clientecrm/node_modules/@babel/runtime/regenerator\";\nimport _objectWithoutProperties from \"D:/Cursos/FrontEnd Javascript/Next/React Avanzado Fullstack Next.js, Apollo, MongoDB y GraphQL/Ejercicios/cliente/clientecrm/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _asyncToGenerator from \"D:/Cursos/FrontEnd Javascript/Next/React Avanzado Fullstack Next.js, Apollo, MongoDB y GraphQL/Ejercicios/cliente/clientecrm/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"D:/Cursos/FrontEnd Javascript/Next/React Avanzado Fullstack Next.js, Apollo, MongoDB y GraphQL/Ejercicios/cliente/clientecrm/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"D:/Cursos/FrontEnd Javascript/Next/React Avanzado Fullstack Next.js, Apollo, MongoDB y GraphQL/Ejercicios/cliente/clientecrm/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\n\nvar _this = this,\n    _jsxFileName = \"D:\\\\Cursos\\\\FrontEnd Javascript\\\\Next\\\\React Avanzado Fullstack Next.js, Apollo, MongoDB y GraphQL\\\\Ejercicios\\\\cliente\\\\clientecrm\\\\pages\\\\nuevopedido.js\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n    mutation nuevoPedido($input : PedidoInput){\\n      nuevoPedido(input : $input){\\n        id\\n      }\\n    }    \\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useContext } from 'react';\nimport Layout from '../components/Layout';\nimport AsignarCliente from '../components/pedidos/AsignarCliente';\nimport AsignarProductos from '../components/pedidos/AsignarProductos';\nimport ResumenPedido from '../components/pedidos/ResumenPedido';\nimport Total from '../components/pedidos/Total';\nimport { gql, useMutation } from '@apollo/client'; //Context de Pedidos\n\nimport PedidoContext from '../context/pedidos/PedidoContext';\nvar NUEVO_PEDIDO = gql(_templateObject());\n\nvar NuevoPedido = function NuevoPedido() {\n  _s();\n\n  var _useStat = useStat,\n      _useStat2 = _slicedToArray(_useStat, 2),\n      mensaje = _useStat2[0],\n      setMensaje = _useStat2[1]; //Utilizar context y extraer sus funciones\n\n\n  var pedidoContext = useContext(PedidoContext); // console.log(pedidoContext);\n  // const {holaMundoEnUseReducer} = pedidoContext\n  // holaMundoEnUseReducer();\n\n  var cliente = pedidoContext.cliente,\n      productos = pedidoContext.productos,\n      total = pedidoContext.total;\n  var id = cliente.id; //Mutation para nuevo Pedido\n\n  var _useMutation = useMutation(NUEVO_PEDIDO),\n      _useMutation2 = _slicedToArray(_useMutation, 1),\n      nuevoPedido = _useMutation2[0];\n\n  var validarPedido = function validarPedido() {\n    return !productos.every(function (producto) {\n      return producto.cantidad > 0;\n    }) || total === 0 || cliente.length === 0 ? \" opacity-50 cursor-not-allowed\" : \"\";\n  };\n\n  var crearNuevoPedido = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var pedido, _yield$nuevoPedido, data;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              //Remover atributos que no van \n              pedido = productos.map(function (_ref2) {\n                var existencia = _ref2.existencia,\n                    __typename = _ref2.__typename,\n                    producto = _objectWithoutProperties(_ref2, [\"existencia\", \"__typename\"]);\n\n                return producto;\n              });\n              _context.prev = 1;\n              _context.next = 4;\n              return nuevoPedido({\n                variables: {\n                  input: {\n                    cliente: id,\n                    total: total,\n                    pedido: pedido\n                  }\n                }\n              });\n\n            case 4:\n              _yield$nuevoPedido = _context.sent;\n              data = _yield$nuevoPedido.data;\n              console.log(data);\n              _context.next = 12;\n              break;\n\n            case 9:\n              _context.prev = 9;\n              _context.t0 = _context[\"catch\"](1);\n              setMensaje(_context.t0.message.replace('Error : ', ''));\n\n            case 12:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[1, 9]]);\n    }));\n\n    return function crearNuevoPedido() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var mostrarMensaje = function mostrarMensaje() {\n    return __jsx(\"div\", {\n      className: \"bg-white py-2 px-3 w-full my-3 max-w-sm text-center mx-auto\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 7\n      }\n    }, __jsx(\"p\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 9\n      }\n    }, mensaje));\n  };\n\n  return __jsx(Layout, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 5\n    }\n  }, __jsx(\"h1\", {\n    className: \"text-2xl text-gray-800 font-light\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 9\n    }\n  }), mensaje && mostrarMensaje, __jsx(\"div\", {\n    className: \"flex justify-center mt-5\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 9\n    }\n  }, __jsx(\"div\", {\n    className: \"w-full max-w-lg\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 11\n    }\n  }, __jsx(AsignarCliente, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 13\n    }\n  }), __jsx(AsignarProductos, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 13\n    }\n  }), __jsx(ResumenPedido, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 13\n    }\n  }), __jsx(Total, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 13\n    }\n  }), __jsx(\"button\", {\n    type: \"button\",\n    className: \"bg-gray-800 w-full mt-5 p-2 text-white uppercase font-bold hover:bg-gray-700 \".concat(validarPedido()),\n    onClick: crearNuevoPedido,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 13\n    }\n  }, \"Registrar Pedido\"))));\n};\n\n_s(NuevoPedido, \"dWegridvJGirucMDGwtNbHnCHs0=\", false, function () {\n  return [useMutation];\n});\n\n_c = NuevoPedido;\nexport default NuevoPedido;\n\nvar _c;\n\n$RefreshReg$(_c, \"NuevoPedido\");","map":{"version":3,"sources":["D:/Cursos/FrontEnd Javascript/Next/React Avanzado Fullstack Next.js, Apollo, MongoDB y GraphQL/Ejercicios/cliente/clientecrm/pages/nuevopedido.js"],"names":["React","useContext","Layout","AsignarCliente","AsignarProductos","ResumenPedido","Total","gql","useMutation","PedidoContext","NUEVO_PEDIDO","NuevoPedido","useStat","mensaje","setMensaje","pedidoContext","cliente","productos","total","id","nuevoPedido","validarPedido","every","producto","cantidad","length","crearNuevoPedido","pedido","map","existencia","__typename","variables","input","data","console","log","message","replace","mostrarMensaje"],"mappings":"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","sourcesContent":["import React, { useContext } from 'react'\r\nimport Layout from '../components/Layout'\r\nimport AsignarCliente from '../components/pedidos/AsignarCliente'\r\nimport AsignarProductos from '../components/pedidos/AsignarProductos'\r\nimport ResumenPedido from '../components/pedidos/ResumenPedido'\r\nimport Total from '../components/pedidos/Total'\r\nimport {gql, useMutation} from '@apollo/client'\r\n//Context de Pedidos\r\nimport PedidoContext from '../context/pedidos/PedidoContext'\r\n\r\nconst NUEVO_PEDIDO = gql`\r\n    mutation nuevoPedido($input : PedidoInput){\r\n      nuevoPedido(input : $input){\r\n        id\r\n      }\r\n    }    \r\n`\r\nconst NuevoPedido = () => {\r\n  const [mensaje, setMensaje] = useStat\r\n  //Utilizar context y extraer sus funciones\r\n  const pedidoContext = useContext(PedidoContext);\r\n  // console.log(pedidoContext);\r\n  // const {holaMundoEnUseReducer} = pedidoContext\r\n  // holaMundoEnUseReducer();\r\n  const {cliente, productos, total} = pedidoContext;\r\n \r\n  const { id} = cliente;\r\n\r\n  //Mutation para nuevo Pedido\r\n  const [nuevoPedido] = useMutation(NUEVO_PEDIDO);\r\n\r\n  const validarPedido = () => {\r\n    return !productos.every(producto => producto.cantidad > 0 ) || total === 0 || cliente.length === 0? \" opacity-50 cursor-not-allowed\" :\"\" ;\r\n  }\r\n  const crearNuevoPedido = async ()=>{\r\n    //Remover atributos que no van \r\n    const pedido = productos.map(({existencia,__typename, ...producto})=>producto)\r\n    try{\r\n      const {data} = await nuevoPedido({\r\n        variables : {\r\n          input : {\r\n            cliente : id,\r\n            total, \r\n            pedido\r\n          }\r\n        }\r\n      })\r\n      console.log(data);\r\n    }catch(error){\r\n      setMensaje(error.message.replace('Error : ', ''))\r\n    }\r\n  }\r\n  const mostrarMensaje = ()=>{\r\n    return (\r\n      <div className='bg-white py-2 px-3 w-full my-3 max-w-sm text-center mx-auto'>\r\n        <p>{mensaje}</p>\r\n      </div>\r\n    )\r\n  }\r\n  return (\r\n    <Layout>\r\n        <h1 className='text-2xl text-gray-800 font-light'></h1>\r\n        {mensaje && mostrarMensaje}\r\n        <div className='flex justify-center mt-5'>\r\n          <div className='w-full max-w-lg'>\r\n            <AsignarCliente/>\r\n            <AsignarProductos/> \r\n            <ResumenPedido/>\r\n            <Total/>\r\n            <button\r\n              type='button'\r\n              className={`bg-gray-800 w-full mt-5 p-2 text-white uppercase font-bold hover:bg-gray-700 ${validarPedido()}`}\r\n              onClick = {crearNuevoPedido}\r\n            >\r\n              Registrar Pedido\r\n            </button>\r\n          </div>\r\n        </div>\r\n    </Layout>\r\n  )\r\n}\r\n\r\nexport default NuevoPedido"]},"metadata":{},"sourceType":"module"}